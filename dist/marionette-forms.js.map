{"version":3,"sources":["../src/lib/models/FormModel.js","../src/lib/views/FormView.js"],"names":[],"mappings":"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","file":"marionette-forms.js","sourcesContent":["Backbone.Marionette.FormModel = Backbone.Model.extend({\n    // validar cada tipo de datos lanzando un evento\n\n    validations: {\n        email: /^[\\w\\-]{1,}([\\w\\-\\+.]{1,1}[\\w\\-]{1,}){0,}[@][\\w\\-]{1,}([.]([\\w\\-]{1,})){1,3}$/,\n        url: /^(http|https):\\/\\/(([A-Z0-9][A-Z0-9_\\-]*)(\\.[A-Z0-9][A-Z0-9_\\-]*)+)(:(\\d+))?\\/?/i,\n        number: /^[0-9]*\\.?[0-9]*?$/,\n        text: function(input, opts) {\n            var length =  (opts.options && opts.options.length) ? opts.options.length : 3; \n            return (_.isString(input) && input.length >= length);\n        },\n        select: function(input, opts) {\n            var def = (opts.options && opts.options.default) ? opts.options.default : \"0\";\n            return (_.isString(input) && input !== def);\n        },\n        password: function(input, opts) {\n            if (_.has(opts.options, 'repeat') ) {\n\n                    if (_.isString(opts.options.repeat)) {\n                        opts.options.repeat = $(opts.options.repeat);\n                    }\n\n                    if (opts.options.repeat instanceof jQuery) {\n\n                        return opts.options.repeat.val() === input;\n\n                    } else {\n                        return this.validateText(input, opts);\n                    }\n                } else {\n                    return this.validateText(input, opts);\n            }\n        },\n        regexp: function(input, opts) {\n            if (!_.has(opts.options, 'regexp')) {\n                throw new Error(\"Regexp validation must have a regexp option to validate it\");\n            }\n\n            if (!_.isRegExp(opts.options.regexp)) {\n                throw new Error(\"options.regexp must be a regular expression\");  \n            }\n\n            return opts.options.regexp.test(input);\n        },\n        radio: function(input, opts) {\n            console.log(input);\n            return (!_.isUndefined(input));\n        },\n        checkbox: function(input, opts) {\n            return input;\n        },\n        custom: function(input, opts) {\n            if (!_.isFunction(opts.options.regexp)) {\n                throw new Error(\"options must be a function\");\n            }\n            return opts.options(input);\n        }\n    },\n\n    validate: function(attributes, options) {\n\n        if (_.has(options, 'key') && _.has(options, 'type') && _.contains(_.keys(this.validations), options.type)) {\n            var valid;\n            if (_.isFunction(this.validations[options.type])) {\n                valid = this.validations[options.type](attributes[options.key], options);\n            } else {\n                valid = this.validations[options.type].test(attributes[options.key]);\n            }\n\n            if (!valid) {\n                this.trigger('invalid:'+options.key, options);\n                return options.message;\n            }\n        }\n    }\n\n});","Backbone.Marionette.FormView = Backbone.Marionette.View.extend({\n\n    defaultSchema: {\n        ui: null,\n        event: null,\n        validate: true,\n        type: 'text',\n        message: 'invalid field'\n    },\n\n    schema: {},\n\n    ui: {},\n\n    constructor: function(options) {\n\n        if (_.isUndefined(options) || _.isUndefined(options.model)) {\n            this.model = new Backbone.Marionette.FormModel();\n        }\n\n        if (!_.isUndefined(options) &&_.has(options, 'schema')) {\n            _.extend(this.schema, options.schema);\n        }\n\n        Backbone.Marionette.View.apply(this, arguments);\n\n        if (_.isEmpty(this.schema)) {\n            throw new Error(\"FormView instance has empty schema\");\n        }\n    },\n\n    delegateFormEvents: function() {\n\n        if (!this.$el) {\n            return;\n        }\n\n        _.each(this.schema, _.bind(function(_item, key) {\n\n            var item = _.extend(_.clone(this.defaultSchema), _item);\n            item.key = key;\n\n            if (_.isNull(item.ui) || _.isNull(item.event)) {\n                return;\n            }\n\n            this.ui[key] = this.$el.find(item.ui);\n            this.delegate(item.event, item.ui, _.bind(this.saveItem, this), item);\n\n            if (item.validate) {\n                this.ui[key].addClass('required');\n                this.listenTo(this.model, 'invalid:'+key, this.errorItem);\n            }\n\n        }, this));\n\n        this.listenTo(this.model, 'invalid', this.invalid);\n    },\n\n    delegate: function(eventName, selector, listener, options) {\n        var opts = options || {};\n        this.$el.on(eventName + '.formEvents' + this.cid, selector, opts, listener);\n    },\n\n    undelegateFormEvents: function() {\n        if (this.$el) {\n            this.$el.off('.formEvents' + this.cid);\n        }\n        return this;\n    },\n\n    delegateEvents: function(events) {\n        this._delegateDOMEvents(events);\n        // delegate automatically form events\n        this.delegateFormEvents();\n        this.bindEntityEvents(this.model, this.getOption('modelEvents'));\n        this.bindEntityEvents(this.collection, this.getOption('collectionEvents'));\n        return this;\n    },\n\n    undelegateEvents: function() {\n        var args = Array.prototype.slice.call(arguments);\n        Backbone.View.prototype.undelegateEvents.apply(this, args);\n        // undelegate automatically form events\n        this.undelegateFormEvents();\n        this.unbindEntityEvents(this.model, this.getOption('modelEvents'));\n        this.unbindEntityEvents(this.collection, this.getOption('collectionEvents'));\n        return this;\n    },\n\n    saveItem: function(event) {\n        var options = event.data || null, val;\n        if (_.isNull(options)) {\n            return;\n        }\n        this.valid();\n        this.ui[options.key].removeClass('invalid');\n\n        switch(options.type) {\n            case 'checkbox':\n                val = this.ui[options.key].is(':checked');\n                break;\n            case 'radio':\n                val =  this.ui[options.key].filter(':checked').val();\n                break;\n            default:\n                val =  this.ui[options.key].val();\n                break;\n        }\n\n        this.model.set(options.key, val, options);\n    },\n\n    errorItem: function(options) {\n        if (!options || _.isEmpty(options) || !this.ui[options.key]) {\n            return;\n        }\n        this.ui[options.key].addClass('invalid');\n    },\n\n    invalid: function() {\n        // override this function\n    },\n\n    valid: function() {\n        // override this function\n    }\n\n});"]}