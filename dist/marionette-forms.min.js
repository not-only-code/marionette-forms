!function(){"use strict";var a=Backbone.Model.extend({types:["email","text","number","url"],validations:{email:/^[\w\-]{1,}([\w\-\+.]{1,1}[\w\-]{1,}){0,}[@][\w\-]{1,}([.]([\w\-]{1,})){1,3}$/,url:/^(http|https):\/\/(([A-Z0-9][A-Z0-9_\-]*)(\.[A-Z0-9][A-Z0-9_\-]*)+)(:(\d+))?\/?/i,number:/^[0-9]*\.?[0-9]*?$/,text:function(a){return"string"==typeof a&&a.length>2}},validate:function(a,b){if(_.has(b,"key")&&_.has(b,"type")&&_.contains(this.types,b.type)){var c;if(c="function"==typeof this.validations[b.type]?this.validations[b.type](a[b.key]):this.validations[b.type].test(a[b.key]),!c)return this.trigger("invalid:"+b.key,b),b.message}}});Backbone.Marionette.FormModel=a;var b=Backbone.Marionette.View.extend({defaultSchema:{ui:null,event:null,validate:!1,type:"text",message:"invalid field"},delegateFormEvents:function(){!_.isEmpty(this.schema)&&this.$el&&(_.isUndefined(this.ui)&&(this.ui={}),_.isUndefined(this.model)&&(this.model=new Backbone.Marionette.FormModel),_.each(this.schema,_.bind(function(a,b){var c=_.extend(_.clone(this.defaultSchema),a);c.key=b,_.isNull(c.ui)||_.isNull(c.event)||(this.ui[b]=this.$el.find(c.ui),this.delegate(c.event,c.ui,_.bind(this.saveItem,this),c),c.validate&&this.listenTo(this.model,"invalid:"+b,this.errorItem))},this)),this.listenTo(this.model,"invalid",this.invalid))},delegate:function(a,b,c,d){var e=d||{};this.$el.on(a+".formEvents"+this.cid,b,e,c)},undelegateFormEvents:function(){return this.$el&&this.$el.off(".formEvents"+this.cid),this},delegateEvents:function(a){return this._delegateDOMEvents(a),this.delegateFormEvents(),this.bindEntityEvents(this.model,this.getOption("modelEvents")),this.bindEntityEvents(this.collection,this.getOption("collectionEvents")),this},undelegateEvents:function(){var a=Array.prototype.slice.call(arguments);return Backbone.View.prototype.undelegateEvents.apply(this,a),this.undelegateFormEvents(),this.unbindEntityEvents(this.model,this.getOption("modelEvents")),this.unbindEntityEvents(this.collection,this.getOption("collectionEvents")),this},saveItem:function(a){var b=a.data||null;_.isNull(b)||(this.valid(),this.ui[b.key].removeClass("error"),this.model.set(b.key,this.ui[b.key].val(),b))},errorItem:function(a){a&&!_.isEmpty(a)&&this.ui[a.key]&&this.ui[a.key].addClass("error")},invalid:function(){},valid:function(){}});Backbone.Marionette.FormView=b}(window||global||this);